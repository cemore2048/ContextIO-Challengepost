<!doctype html>
<html>

<head>
	<title> </title>
	<script src="/d3.min.js" type="text/javascript"></script>
	<script src="/jquery-2.1.4.js"></script>


	<script>
	var data;
	var offset = 0;
	var maxOffset = 1000;
	var messagesUrl = "/api/messages";
	var contactsUrl = "api/messages";

	var messagesCallback = function(json) {
		var aggregateResponse = [];
		aggregateResponse.push(json);
		console.log("current offset: "  + offset);
		var count = 0;
		console.log(json);

		if(json != null){
			console.log("made it into null check");
			for(var i = 0; i < json.length; i++){
				console.log("count is : " + count);
				count++;
			}
		}

		data = json;

		offset += 100;

		if(offset > maxOffset){
			var end = new Date().getTime();
			var time = end - start;
			console.log("Time to execute : "  + time/1000);
			//aqui vas a hacer la visualisacion

			return aggregateResponse;
		}

		d3.json(messagesUrl + "/" + offset, messagesCallback);
	}

	var contactsCallback = function(json){
		
	}
	var getListOfContacts = function(){
		d3.json(contactsUrl + "/" + offset, contactsCallback);
	}

	$(document).ready(function(){
		$('button').click(function(){
			var start = new Date().getTime();
			//d3.json is asynchronous. the program will get to this function
			//and immediately go to the next line while the function is still running
			//because of that. the visualization must be called within the callback
			d3.json(messagesUrl + "/" + offset, callback);



		});
	});

	</script>
</head>
<body>
		<button>Send an HTTP GET request to a page and get the result back</button>
</body>
<html>
